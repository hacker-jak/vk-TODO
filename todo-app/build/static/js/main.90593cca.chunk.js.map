{"version":3,"sources":["App.js","index.js"],"names":["RemoveBtn","props","className","onClick","OnClick","Add","useState","value","setValue","onSubmit","event","preventDefault","OnSubmit","type","name","onChange","target","Save","Saved","Item","checked","this","OnCheck","index","React","Component","TodoList","item_list","items","count","forEach","state","saveFunc","saved","check","i","handleCheck","updated","d_count","setState","splice","text","push","u_count","then","result","catch","err","console","log","length","map","makeItem","handleRemove","handleAdd","handleSave","App","appId","scope","id","error","isLoaded","bridge","send","url","fetch","res","json","list","todo_list","json_list","requestOptions","method","headers","body","JSON","stringify","Promise","resolve","reject","response","ok","message","bind","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.90593cca.chunk.js","sourcesContent":["import React, { useState } from 'react'\nimport bridge from '@vkontakte/vk-bridge'\n\nfunction RemoveBtn(props){\n  return(\n    <button className=\"remove_btn\" onClick={props.OnClick}>\n      Remove\n    </button>\n  );\n}\n\nfunction Add(props){\n  const [value, setValue] = useState()\n  return(\n    <form onSubmit={(event)=>{event.preventDefault(); props.OnSubmit(value); setValue('')}}>\n      <input type='text' name='item' value={value} onChange={(event)=>setValue(event.target.value)}></input>\n      <input type='submit' value='Add' className=\"add_btn\"/>\n    </form> \n  )\n}\n\nfunction Save(props){\n  return(\n    <form onSubmit={(event)=>{event.preventDefault(); props.OnSubmit()}}>\n      <input type='submit' value='Save' className=\"save_btn\"/>\n      {props.Saved &&\n        <span>&#10003;</span>\n      }\n    </form>\n  )\n}\n\nclass Item extends React.Component{\n  render(){\n    return (\n      <div className=\"todo-item\">\n        <input type='checkbox' checked={this.props.checked} onChange={()=>this.props.OnCheck(!this.props.checked, this.props.index)} key={this.props.index}/>\n        {this.props.value}\n      </div>\n    );\n  }\n}\n\nclass TodoList extends React.Component{ \n  constructor(props){\n    super(props);\n\n    var item_list = this.props.items;\n    var count = 0;\n\n    item_list.forEach((value, index)=>{\n      var checked = value[1]\n      if(checked)\n        count+=1;\n    });\n\n    this.state = {\n      items: item_list,\n      count: count,\n      saveFunc: props.saveFunc,\n      saved: true\n    }\n  }\n  \n  makeItem(value, index, checked){\n    return(<Item index={index} value={value} checked={checked} OnCheck={(check, i)=>this.handleCheck(check, i)}/>)\n  }\n\n  handleRemove(index){\n    var updated = this.state.items\n\n    if(updated[index][1]){\n      var d_count = this.state.count -1;\n      this.setState({count: d_count})\n    }\n\n    updated.splice(index, 1)\n    this.setState({items: updated, saved: false})\n  }\n\n  handleAdd(text){\n    var updated = this.state.items\n    updated.push([text, false])\n    this.setState({items: updated, saved: false})\n  }\n\n  handleCheck(checked, index){\n    var items = this.state.items\n    var u_count = this.state.count\n\n    if(checked){\n      items[index][1] = true\n      u_count += 1;\n    }else{\n      items[index][1] = false\n      u_count -= 1; \n    }\n    this.setState({count: u_count, item_list: items, saved: false});\n  }\n\n  handleSave(){\n    // Returns a promise, .then can be used to set values async on response\n    this.props.saveFunc(this.state.items)\n      .then(result=>{\n        this.setState({saved: true})\n      }).catch(err=>console.log(\"handleSave() encountered an error\"))\n  }\n\n  render(){\n    return (\n      <div className=\"todo-list\">\n        <h2>Complete: {this.state.count}/{this.state.items.length}</h2>\n        <ul>\n          {this.state.items.map((value, index) =>{\n            return (<div> {this.makeItem(value[0], index, value[1])} <RemoveBtn OnClick={()=>this.handleRemove(index)}/></div>)\n          })}\n        </ul>\n        <Add OnSubmit={(text)=>this.handleAdd(text)}/>\n        <Save Saved={this.state.saved} OnSubmit={()=>this.handleSave()}/>\n      </div>\n    );\n  }\n}\n\nclass App extends React.Component {\n  constructor(props){\n    super(props);\n\n    this.appId = '7786895'\n    this.scope = 'friends'\n\n    this.id = '12345'\n\n    this.state = {\n      error: null,\n      isLoaded: false,\n      items: []\n    };\n  }\n\n  componentDidMount(){\n    // Init the VK web app with vk servers\n    bridge.send(\"VKWebAppInit\",{})\n\n    bridge.send('VKWebAppGetUserInfo')\n      .then(result=>console.log(result))\n      .catch(error=>console.log(error))\n\n    // Get an access_token for the current user\n    bridge.send(\"VKWebAppGetAuthToken\", {\"app_id\": this.appId, \"scope\": this.scope})\n      .then(result=>console.log(result))\n      .catch(error=>console.log(error))\n\n    this.url = \"https://darkjakeco.pythonanywhere.com/\"\n\n    fetch(this.url+this.id)\n    .then(res => res.json())\n    .then(\n      (result) => {\n        this.setState({\n          isLoaded: true,\n          items: result.list\n        });\n      },\n      (error) => {\n        this.setState({\n          isLoaded: false,\n          error: error\n        });\n      }\n    )\n  }\n\n  saveFunc(todo_list){\n    // Send POST request to server to save updated list\n    var json_list = {\n      'list': todo_list\n    }\n\n    const requestOptions = {\n      method: 'POST',\n      headers: {'Content-Type': 'application/json'},\n      body: JSON.stringify(json_list)\n    };\n    \n    // `this.id` is the reason for the \".bind(this)\" used in `render()` for saveFunc\n    // otherwise `this` doesn't reference `App`\n    var url = this.url+\"save/\"+this.id\n\n    // Return a promise object so that the calling func can set values async with response\n    return new Promise((resolve, reject)=>{\n      fetch(url, requestOptions)\n      .then(response=>{\n        if(response.ok){\n          resolve(true)\n        }\n      }).catch(\n          error=>{\n            console.log(error)\n            reject(false)\n          }\n      )\n    })\n  }\n\n  render(){\n    const { error, isLoaded, items } = this.state;\n\n    if(error){\n      return <div>Error: {error.message}</div>;\n    }else if(!isLoaded){\n      return <div>Loading...</div>;\n    }else{\n      return (\n        <div className=\"App\">\n          <header className=\"App-header\">\n          <h1>TODO List</h1> \n          <TodoList saveFunc={this.saveFunc.bind(this)} items={items}/>\t\n          </header>\n        </div>\n      );\n    }\n  }\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}